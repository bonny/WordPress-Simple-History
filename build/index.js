(()=>{"use strict";var e={20:(e,t,n)=>{var a=n(609),r=Symbol.for("react.element"),s=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,n){var a,l={},c=null,m=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(m=t.ref),t)s.call(t,a)&&!o.hasOwnProperty(a)&&(l[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===l[a]&&(l[a]=t[a]);return{$$typeof:r,type:e,key:c,ref:m,props:l,_owner:i.current}}},848:(e,t,n)=>{e.exports=n(20)},609:e=>{e.exports=window.React}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a=n(609);const r=window.wp.domReady;var s=n.n(r);const i=window.wp.element,o=window.wp.apiFetch;var l=n.n(o);const c=window.wp.compose,m=window.wp.url,u=window.wp.components,d=window.wp.i18n,h=window.wp.primitives;var p=n(848);const g=(0,p.jsx)(h.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)(h.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M15 11h-.2V9c0-1.5-1.2-2.8-2.8-2.8S9.2 7.5 9.2 9v2H9c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1h6c.6 0 1-.4 1-1v-4c0-.6-.4-1-1-1zm-1.8 0h-2.5V9c0-.7.6-1.2 1.2-1.2s1.2.6 1.2 1.2v2z"})}),f=(0,p.jsx)(h.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(h.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})}),y=function(){return(0,a.createElement)("span",{style:{color:"darkgreen",fontSize:"0.8em",border:"1px solid darkgreen",borderRadius:"5px",padding:"0.2em 0.5em",opacity:"0.8",lineHeight:1}},(0,d.__)("Premium","simple-history"))},_=function(){return(0,a.createElement)("span",{style:{color:"darkgreen",fontSize:"0.8em",border:"1px solid darkgreen",borderRadius:"5px",xpadding:"0.1em 0.3em",opacity:"0.75",lineHeight:1}},(0,a.createElement)(u.Icon,{icon:g}))},v=()=>(0,a.createElement)(u.DropdownMenu,{label:(0,d.__)("Actions…","simple-history"),icon:f},(({onClose:e})=>(0,a.createElement)(a.Fragment,null,(0,a.createElement)(u.MenuGroup,null,(0,a.createElement)(u.MenuItem,{onClick:e,info:"Re-use this search in the future"},"Save search"),(0,a.createElement)(u.MenuItem,{onClick:e},"Copy link to search")),(0,a.createElement)(u.MenuGroup,{label:(0,d.__)("Export","simple-history")},(0,a.createElement)(u.MenuItem,{onClick:e,suffix:(0,a.createElement)(y,null)},"Export as CSV..."),(0,a.createElement)(u.MenuItem,{onClick:e,suffix:(0,a.createElement)(y,null)},"Export as JSON")),(0,a.createElement)(u.MenuGroup,null,(0,a.createElement)(u.MenuItem,{onClick:e,suffix:(0,a.createElement)(_,null)},"Add event manually"),(0,a.createElement)(u.MenuItem,{onClick:e,suffix:(0,a.createElement)(_,null)},"Send log via email")))));function w(e){const{isExperimentalFeaturesEnabled:t,eventsIsLoading:n,eventsTotal:r}=e;if(!t)return null;const s=n?(0,a.createElement)(u.__experimentalText,null,(0,a.createElement)(u.Spinner,null),(0,d._x)("Loading…","Message visible while waiting for log to load from server the first time","simple-history")):null,i=r?(0,a.createElement)(u.__experimentalText,null,(0,d.sprintf)(/* translators: %s: number of events */ /* translators: %s: number of events */
(0,d._n)("%s event","%s events",r,"simple-history"),r)):null;return(0,a.createElement)("div",{style:{background:"white",padding:"6px 12px"}},(0,a.createElement)(u.Flex,{gap:2,style:{}},(0,a.createElement)(u.FlexItem,null,(0,a.createElement)(u.__experimentalHStack,{spacing:2},i,s)),(0,a.createElement)(u.FlexItem,null,(0,a.createElement)(v,null))))}const E=(0,p.jsx)(h.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(h.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})}),b=(0,p.jsx)(h.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(h.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})});function S(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=S(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function x(){for(var e,t,n=0,a="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=S(e))&&(a&&(a+=" "),a+=t);return a}const k={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function M(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const L={date:M({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:M({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:M({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},C={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function T(e){return(t,n)=>{let a;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,r=n?.width?String(n.width):t;a=e.formattingValues[r]||e.formattingValues[t]}else{const t=e.defaultWidth,r=n?.width?String(n.width):e.defaultWidth;a=e.values[r]||e.values[t]}return a[e.argumentCallback?e.argumentCallback(t):t]}}function D(e){return(t,n={})=>{const a=n.width,r=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],s=t.match(r);if(!s)return null;const i=s[0],o=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e){for(let t=0;t<e.length;t++)if(e[t].test(i))return t}(o):function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t].test(i))return t}(o);let c;return c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c,{value:c,rest:t.slice(i.length)}}}var H;const P={code:"en-US",formatDistance:(e,t,n)=>{let a;const r=k[e];return a="string"==typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a},formatLong:L,formatRelative:(e,t,n,a)=>C[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:T({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:T({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:T({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:T({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:T({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(H={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(H.matchPattern);if(!n)return null;const a=n[0],r=e.match(H.parsePattern);if(!r)return null;let s=H.valueCallback?H.valueCallback(r[0]):r[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(a.length)}}),era:D({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:D({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:D({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:D({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:D({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};let I={};function F(){return I}Math.pow(10,8);const N=6048e5,O=864e5;function A(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):"number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?new Date(e):new Date(NaN)}function W(e){const t=A(e);return t.setHours(0,0,0,0),t}function j(e){const t=A(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function z(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function B(e){const t=A(e);return function(e,t){const n=W(e),a=W(t),r=+n-j(n),s=+a-j(a);return Math.round((r-s)/O)}(t,function(e){const t=A(e),n=z(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}(t))+1}function R(e,t){const n=F(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=A(e),s=r.getDay(),i=(s<a?7:0)+s-a;return r.setDate(r.getDate()-i),r.setHours(0,0,0,0),r}function Y(e){return R(e,{weekStartsOn:1})}function q(e){const t=A(e),n=t.getFullYear(),a=z(e,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const r=Y(a),s=z(e,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const i=Y(s);return t.getTime()>=r.getTime()?n+1:t.getTime()>=i.getTime()?n:n-1}function V(e){const t=A(e),n=+Y(t)-+function(e){const t=q(e),n=z(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Y(n)}(t);return Math.round(n/N)+1}function G(e,t){const n=A(e),a=n.getFullYear(),r=F(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=z(e,0);i.setFullYear(a+1,0,s),i.setHours(0,0,0,0);const o=R(i,t),l=z(e,0);l.setFullYear(a,0,s),l.setHours(0,0,0,0);const c=R(l,t);return n.getTime()>=o.getTime()?a+1:n.getTime()>=c.getTime()?a:a-1}function $(e,t){const n=A(e),a=+R(n,t)-+function(e,t){const n=F(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=G(e,t),s=z(e,0);return s.setFullYear(r,0,a),s.setHours(0,0,0,0),R(s,t)}(n,t);return Math.round(a/N)+1}function Q(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const U={y(e,t){const n=e.getFullYear(),a=n>0?n:1-n;return Q("yy"===t?a%100:a,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):Q(n+1,2)},d:(e,t)=>Q(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>Q(e.getHours()%12||12,t.length),H:(e,t)=>Q(e.getHours(),t.length),m:(e,t)=>Q(e.getMinutes(),t.length),s:(e,t)=>Q(e.getSeconds(),t.length),S(e,t){const n=t.length,a=e.getMilliseconds();return Q(Math.trunc(a*Math.pow(10,n-3)),t.length)}},X={G:function(e,t,n){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});default:return n.era(a,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),a=t>0?t:1-t;return n.ordinalNumber(a,{unit:"year"})}return U.y(e,t)},Y:function(e,t,n,a){const r=G(e,a),s=r>0?r:1-r;return"YY"===t?Q(s%100,2):"Yo"===t?n.ordinalNumber(s,{unit:"year"}):Q(s,t.length)},R:function(e,t){return Q(q(e),t.length)},u:function(e,t){return Q(e.getFullYear(),t.length)},Q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return Q(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return Q(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,n){const a=e.getMonth();switch(t){case"M":case"MM":return U.M(e,t);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,n){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return Q(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,n,a){const r=$(e,a);return"wo"===t?n.ordinalNumber(r,{unit:"week"}):Q(r,t.length)},I:function(e,t,n){const a=V(e);return"Io"===t?n.ordinalNumber(a,{unit:"week"}):Q(a,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):U.d(e,t)},D:function(e,t,n){const a=B(e);return"Do"===t?n.ordinalNumber(a,{unit:"dayOfYear"}):Q(a,t.length)},E:function(e,t,n){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,n,a){const r=e.getDay(),s=(r-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Q(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,a){const r=e.getDay(),s=(r-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Q(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const a=e.getDay(),r=0===a?7:a;switch(t){case"i":return String(r);case"ii":return Q(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const a=e.getHours();let r;switch(r=12===a?"noon":0===a?"midnight":a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const a=e.getHours();let r;switch(r=a>=17?"evening":a>=12?"afternoon":a>=4?"morning":"night",t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return U.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):U.H(e,t)},K:function(e,t,n){const a=e.getHours()%12;return"Ko"===t?n.ordinalNumber(a,{unit:"hour"}):Q(a,t.length)},k:function(e,t,n){let a=e.getHours();return 0===a&&(a=24),"ko"===t?n.ordinalNumber(a,{unit:"hour"}):Q(a,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):U.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):U.s(e,t)},S:function(e,t){return U.S(e,t)},X:function(e,t,n){const a=e.getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return J(a);case"XXXX":case"XX":return Z(a);default:return Z(a,":")}},x:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"x":return J(a);case"xxxx":case"xx":return Z(a);default:return Z(a,":")}},O:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+K(a,":");default:return"GMT"+Z(a,":")}},z:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+K(a,":");default:return"GMT"+Z(a,":")}},t:function(e,t,n){return Q(Math.trunc(e.getTime()/1e3),t.length)},T:function(e,t,n){return Q(e.getTime(),t.length)}};function K(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=Math.trunc(a/60),s=a%60;return 0===s?n+String(r):n+String(r)+t+Q(s,2)}function J(e,t){return e%60==0?(e>0?"-":"+")+Q(Math.abs(e)/60,2):Z(e,t)}function Z(e,t=""){const n=e>0?"-":"+",a=Math.abs(e);return n+Q(Math.trunc(a/60),2)+t+Q(a%60,2)}const ee=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},te=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},ne={p:te,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],a=n[1],r=n[2];if(!r)return ee(e,t);let s;switch(a){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",ee(a,t)).replace("{{time}}",te(r,t))}},ae=/^D+$/,re=/^Y+$/,se=["D","DD","YY","YYYY"];function ie(e){if(!(t=e,t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)||"number"==typeof e))return!1;var t;const n=A(e);return!isNaN(Number(n))}const oe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,le=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ce=/^'([^]*?)'?$/,me=/''/g,ue=/[a-zA-Z]/;function de(e,t,n){const a=F(),r=n?.locale??a.locale??P,s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,i=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,o=A(e);if(!ie(o))throw new RangeError("Invalid time value");let l=t.match(le).map((e=>{const t=e[0];return"p"===t||"P"===t?(0,ne[t])(e,r.formatLong):e})).join("").match(oe).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:he(e)};if(X[t])return{isToken:!0,value:e};if(t.match(ue))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));r.localize.preprocessor&&(l=r.localize.preprocessor(o,l));const c={firstWeekContainsDate:s,weekStartsOn:i,locale:r};return l.map((a=>{if(!a.isToken)return a.value;const s=a.value;return(!n?.useAdditionalWeekYearTokens&&function(e){return re.test(e)}(s)||!n?.useAdditionalDayOfYearTokens&&function(e){return ae.test(e)}(s))&&function(e,t,n){const a=function(e,t,n){const a="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(a),se.includes(e))throw new RangeError(a)}(s,t,String(e)),(0,X[s[0]])(o,s,r.localize,c)})).join("")}function he(e){const t=e.match(ce);return t?t[1].replace(me,"'"):e}function pe(e){const t=A(e);return t.setHours(23,59,59,999),t}const ge=[{label:(0,d.__)("Custom date range…","simple-history"),value:"customRange"},{label:(0,d.__)("Last day","simple-history"),value:"lastdays:1"},{label:(0,d.__)("Last 7 days","simple-history"),value:"lastdays:7"},{label:(0,d.__)("Last 14 days","simple-history"),value:"lastdays:14"},{label:(0,d.__)("Last 30 days","simple-history"),value:"lastdays:30"},{label:(0,d.__)("Last 60 days","simple-history"),value:"lastdays:60"}],fe=[{label:(0,d.__)("Loading…","simple-history"),value:""}],ye=[{label:(0,d._x)("Info","Log level in gui","simple-history"),value:"info"},{label:(0,d._x)("Warning","Log level in gui","simple-history"),value:"warning"},{label:(0,d._x)("Error","Log level in gui","simple-history"),value:"error"},{label:(0,d._x)("Critical","Log level in gui","simple-history"),value:"critical"},{label:(0,d._x)("Alert","Log level in gui","simple-history"),value:"alert"},{label:(0,d._x)("Emergency","Log level in gui","simple-history"),value:"emergency"},{label:(0,d._x)("Debug","Log level in gui","simple-history"),value:"debug"}],_e="yyyy-MM-dd'T'HH:mm:ss",ve=" - ",we=de(W(new Date),_e),Ee=de(pe(new Date),_e);function be({event:e}){window.location.hash=`#simple-history/event/${e.id}`}function Se(e){const{event:t}=e,{details_html:n}=t;return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__details",dangerouslySetInnerHTML:{__html:n}})}const xe=window.wp.date;function ke(e){const{children:t,className:n}=e,r=x("SimpleHistoryLogitem__inlineDivided",n);return(0,a.createElement)(a.Fragment,null," ",(0,a.createElement)("span",{className:r},t))}function Me(e){const{event:t,eventVariant:n}=e,r=(0,xe.getSettings)(),s=r.formats.datetimeAbbreviated,o=r.formats.time;let l;l=(0,xe.date)("Y-m-d",t.date_gmt)===(0,xe.date)("Y-m-d")?(0,d.sprintf)(
// translators: %s is the time, like 8:36 pm.
// translators: %s is the time, like 8:36 pm.
(0,d.__)("Today %s","simple-history"),(0,xe.dateI18n)(o,t.date_gmt)):(0,xe.dateI18n)(s,t.date_gmt);const[c,m]=(0,i.useState)((()=>(0,xe.humanTimeDiff)(t.date_gmt)));(0,i.useEffect)((()=>{const e=setInterval((()=>{m((0,xe.humanTimeDiff)(t.date_gmt))}),1e3);return()=>{clearInterval(e)}}),[t.date_gmt]);const h=(0,d.sprintf)(/* translators: 1: date in local time, 2: date in GMT time */ /* translators: 1: date in local time, 2: date in GMT time */
(0,d.__)("%1$s local time (%2$s GMT time)","simple-history"),t.date,t.date_gmt),p=(0,a.createElement)(a.Fragment,null,(0,a.createElement)("time",{dateTime:t.date_gmt,className:"SimpleHistoryLogitem__when__liveRelative"},l," (",c,")"));return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(ke,{className:"SimpleHistoryLogitem__permalink SimpleHistoryLogitem__when"},(0,a.createElement)(u.Tooltip,{text:h,delay:500},"modal"===n?(0,a.createElement)(u.__experimentalText,null,p):(0,a.createElement)(u.Button,{variant:"link",onClick:()=>{be({event:t})}},p))))}function Le(e){const{event:t,eventVariant:n}=e,{initiator_data:r}=t;switch(t.initiator){case"wp_user":const e=(0,a.createElement)(a.Fragment,null,(0,a.createElement)("strong",null,r.user_login)," ",(0,a.createElement)("span",null,"(",r.user_email,")"));return(0,a.createElement)(ke,null,"modal"===n?(0,a.createElement)(u.__experimentalText,null,e):(0,a.createElement)(u.Button,{href:r.user_profile_url,variant:"link"},e));case"web_user":return(0,a.createElement)(ke,null,(0,a.createElement)("strong",null,(0,d.__)("Anonymous web user","simple-history")));case"wp_cli":return(0,a.createElement)(ke,null,(0,a.createElement)("strong",null,(0,d.__)("WP-CLI","simple-history")));case"wp":return(0,a.createElement)(ke,null,(0,a.createElement)("strong",null,(0,d.__)("WordPress","simple-history")));case"other":return(0,a.createElement)(ke,null,(0,a.createElement)("strong",null,(0,d.__)("Other","simple-history")));default:return(0,a.createElement)(ke,null,"Unknown initiator: ",(0,a.createElement)("code",null,t.initiator))}}const Ce=(0,p.jsx)(h.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(h.Path,{d:"m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"})}),Te=[{key:"hostname",label:(0,d.__)("Hostname:","simple-history")},{key:"org",label:(0,d.__)("Org:","simple-history")},{key:"city",label:(0,d.__)("City:","simple-history")},{key:"region",label:(0,d.__)("Region:","simple-history")},{key:"country",label:(0,d.__)("Country:","simple-history")},{key:"loc",label:(0,d.__)("Location:","simple-history")}];function De(e){const{header:t,ipAddress:n,mapsApiKey:r,hasExtendedSettingsAddOn:s}=e,[o,l]=(0,i.useState)(!1),[c,m]=(0,i.useState)(!1),[h,p]=(0,i.useState)(),g=`https://ipinfo.io/${n.replace(/\.x$/,".0")}`;(0,i.useEffect)((()=>{c&&async function(){const e=await fetch(g,{method:"GET",headers:{Accept:"application/json"}}),t=await e.json();p(t),m(!1)}()}),[c,n,g]);const f=(0,i.createInterpolateElement)((0,d.__)("That IP address does not seem like a public one. It is probably a <a>bogon ip address</a>.","simple-history"),{a:(0,a.createElement)(u.ExternalLink,{href:"https://ipinfo.io/bogon",target:"_blank",rel:"noopener noreferrer"})}),y=r&&!h?.bogon&&h?.loc?(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:2},(0,a.createElement)("a",{href:`https://www.google.com/maps/place/${h.loc}/@${h.loc},6z`,target:"_blank",rel:"noopener noreferrer"},(0,a.createElement)("img",{src:`https://maps.googleapis.com/maps/api/staticmap?center=${h.loc}&zoom=7&size=350x100&scale=2&sensor=false&key=${r}`,width:"350",height:"100",alt:"Google Map"})))):null,_=s?null:(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{style:{display:"grid",placeItems:"center",width:"100%",height:100,backgroundImage:'url("/wp-content/plugins/simple-history/assets/images/map-img-blur.jpg")',backgroundSize:"cover",padding:"1rem"}},(0,a.createElement)(u.__experimentalText,null,(0,i.createInterpolateElement)((0,d.__)("See the location of the IP adress on a map with the <a>Extended Settings</a> add-on.","simple-history"),{a:(0,a.createElement)(u.ExternalLink,{href:"https://simple-history.com/add-ons/extended-settings/?utm_source=plugin&utm_medium=link&utm_campaign=ipinfo#GoogleMaps",target:"_blank",rel:"noopener noreferrer"})})))),v=h?(0,a.createElement)(a.Fragment,null,_,(0,a.createElement)("table",{className:"SimpleHistoryIpInfoDropin__ipInfoTable"},(0,a.createElement)("tbody",null,y,(0,a.createElement)("tr",null,(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},(0,d.__)("IP address:","simple-history")),(0,a.createElement)("td",null,n)),(0,a.createElement)("tr",null,(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},(0,d.__)("Header:","simple-history")),(0,a.createElement)("td",null,(0,a.createElement)("code",null,t))),h.bogon?(0,a.createElement)("tr",null,(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},(0,d.__)("Error:","simple-history")),(0,a.createElement)("td",null,f)):null,Te.map((e=>{const{key:t,label:n}=e,r=h[t];return r?(0,a.createElement)("tr",{key:t},(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},n),(0,a.createElement)("td",null,r)):null})))),(0,a.createElement)(u.__experimentalText,{align:"right",isBlock:!0,variant:"muted",style:{marginTop:10}},(0,i.createInterpolateElement)((0,d.__)("IP info provided by <a>ipinfo.io</a>","simple-history"),{a:(0,a.createElement)(u.ExternalLink,{href:"https://ipinfo.io/",target:"_blank",rel:"noopener noreferrer"})}))):null;return(0,a.createElement)(u.Button,{title:t,onClick:e=>{"BUTTON"!==e.target.nodeName||(o?l(!1):(l(!0),m(!0)))},variant:"link"},n,o?(0,a.createElement)(u.Popover,{noArrow:!1,offset:10,placement:"top",animate:!0,shift:!0},(0,a.createElement)("div",{style:{minWidth:350,minHeight:100,padding:10,overflow:"hidden"}},(0,a.createElement)(u.Flex,{align:"start"},(0,a.createElement)("div",null,c?(0,a.createElement)("p",null,(0,d.__)("Getting IP info…","simple-history")):(0,a.createElement)(a.Fragment,null,v)),(0,a.createElement)(u.Button,{icon:Ce,onClick:()=>l(!1)})))):null)}function He(e){const{event:t,mapsApiKey:n,hasExtendedSettingsAddOn:r}=e,{ip_addresses:s}=t;if(!s)return null;const i=Object.keys(s).length;if(0===i)return null;const o=(0,d._n)("IP address:","IP addresses:",i,"simple-history"),l=[];let c=0;for(const[e,t]of Object.entries(s))l.push((0,a.createElement)(a.Fragment,null,(0,a.createElement)(De,{key:e,header:e,ipAddress:t,mapsApiKey:n,hasExtendedSettingsAddOn:r})," ",c<i-1?", ":"")),c++;return(0,a.createElement)(ke,null,o," ",l)}function Pe(e){const{event:t}=e,{via:n}=t;return n?(0,a.createElement)(ke,null,n):null}function Ie(e){const{event:t,eventVariant:n,hasExtendedSettingsAddOn:r}=e,{mapsApiKey:s}=e;return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__header"},(0,a.createElement)(Le,{event:t,eventVariant:n}),(0,a.createElement)(Me,{event:t,eventVariant:n}),(0,a.createElement)(He,{event:t,mapsApiKey:s,hasExtendedSettingsAddOn:r}),(0,a.createElement)(Pe,{event:t}))}function Fe(e){const{event:t}=e,{initiator_data:n}=t;return(0,a.createElement)("img",{className:"SimpleHistoryLogitem__senderImage",src:n.user_avatar_url,alt:""})}function Ne(e){const{event:t}=e,{initiator_data:n}=t;return(0,a.createElement)("img",{className:"SimpleHistoryLogitem__senderImage",src:n.user_avatar_url,alt:""})}function Oe(e){return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__senderImage"})}function Ae(e){const{event:t}=e,{initiator:n}=t;switch(n){case"wp_user":return(0,a.createElement)(Fe,{event:t});case"web_user":return(0,a.createElement)(Ne,{event:t});case"wp_cli":case"wp":case"other":return(0,a.createElement)(Oe,{event:t});default:return(0,a.createElement)("p",null,'Add image for initiator "',n,'"')}}function We(e){const{occasions:t,isLoadingOccasions:n,subsequent_occasions_count:r,occasionsCountMaxReturn:s}=e,i=x({SimpleHistoryLogitems:!0,SimpleHistoryLogitem__occasionsItems:!0,haveOccasionsAdded:!1===n});return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__occasionsItemsWrap",style:{marginTop:"1rem",marginLeft:"-4.5rem",marginRight:"-1.5rem"}},(0,a.createElement)("ul",{className:i},t.map((e=>(0,a.createElement)(Ve,{key:e.id,event:e}))),r>s?(0,a.createElement)("li",{className:"SimpleHistoryLogitem SimpleHistoryLogitem--occasion SimpleHistoryLogitem--occasion-tooMany"},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__firstcol"}),(0,a.createElement)("div",{className:"SimpleHistoryLogitem__secondcol"},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__text"},(0,d.__)("Sorry, but there are too many similar events to show.","simple-history")))):null))}function je(e){const{event:t,hasExtendedSettingsAddOn:n}=e;return"SimpleUserLogger"!==t.logger||"user_login_failed"!==t.message_key&&"user_unknown_login_failed"!==t.message_key?null:(0,a.createElement)("div",{className:"SimpleHistoryLogitem__occasionsAddOns"},(0,a.createElement)("p",{className:"SimpleHistoryLogitem__occasionsAddOnsText"},n?(0,a.createElement)("a",{href:"options-general.php?page=simple_history_settings_menu_slug&selected-sub-tab=failed-login-attempts"},(0,d.__)("Configure failed login attempts","simple-history")):(0,a.createElement)(u.ExternalLink,{href:"https://simple-history.com/add-ons/extended-settings/?utm_source=wpadmin#limit-number-of-failed-login-attempts"},(0,d.__)("Limit logged login attempts","simple-history"))))}function ze(e){const{event:t,eventVariant:n,hasExtendedSettingsAddOn:r}=e,{subsequent_occasions_count:s}=t,[o,c]=(0,i.useState)(!1),[h,p]=(0,i.useState)(!1),[g,f]=(0,i.useState)([]);if(1===s)return null;if("modal"===n)return null;const y=(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"SimpleHistoryLogitem__occasions"},(0,a.createElement)(u.Button,{variant:"link",onClick:e=>{(async()=>{c(!0);const e={type:"occasions",logRowID:t.id,occasionsID:t.occasions_id,occasionsCount:s-1,occasionsCountMaxReturn:15,per_page:5,_fields:["id","date","date_gmt","message","message_html","details_data","details_html","loglevel","occasions_id","subsequent_occasions_count","initiator","initiator_data","via"]},n=await l()({path:(0,m.addQueryArgs)("/simple-history/v1/events",e),parse:!1}),a=await n.json();f(a),c(!1),p(!0)})(),e.preventDefault()}},(0,d.sprintf)(/* translators: %s: number of similar events */ /* translators: %s: number of similar events */
(0,d._n)("+%1$s similar event","+%1$s similar events",s,"simple-history"),s)),(0,a.createElement)(je,{event:t,hasExtendedSettingsAddOn:r})));return(0,a.createElement)("div",null,h||o?null:y,o?(0,a.createElement)("span",null,(0,d.__)("Loading…","simple-history")):null,h?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("span",null,(0,d.sprintf)(/* translators: %s: number of similar events */ /* translators: %s: number of similar events */
(0,d.__)("Showing %1$s more","simple-history"),s-1)),(0,a.createElement)(We,{isLoadingOccasions:o,isShowingOccasions:h,occasions:g,subsequent_occasions_count:s,occasionsCountMaxReturn:15})):null)}function Be(e){const{event:t}=e,n=x("SimpleHistoryLogitem--logleveltag",`SimpleHistoryLogitem--logleveltag-${t.loglevel}`);return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__text"},(0,a.createElement)("span",{dangerouslySetInnerHTML:{__html:t.message_html}})," ",(0,a.createElement)("span",{className:n},t.loglevel))}function Re({event:e}){const t=e.permalink,n=(0,d.__)("Copy link to event","simple-history"),r=(0,d.__)("Link copied to clipboard","simple-history"),[s,o]=(0,i.useState)(n),l=(0,c.useCopyToClipboard)(t,(()=>{o(r),setTimeout((()=>{o(n)}),2e3)}));return(0,a.createElement)(u.MenuItem,{icon:E,iconPosition:"left",ref:l},s)}function Ye({event:e,onClose:t}){return(0,a.createElement)(u.MenuItem,{icon:b,iconPosition:"left",onClick:()=>{be({event:e}),t()}},(0,d.__)("View event details","simple-history"))}function qe(e){const{event:t}=e,n=e.eventVariant;return"modal"===n?null:(0,a.createElement)("div",{className:"SimpleHistoryLogitem__actions"},(0,a.createElement)(u.DropdownMenu,{label:(0,d.__)("Actions…","simple-history"),icon:f,popoverProps:{placement:"left-start",inline:!0}},(({onClose:e})=>(0,a.createElement)(a.Fragment,null,(0,a.createElement)(u.MenuGroup,null,(0,a.createElement)(Ye,{event:t,eventVariant:n,onClose:e}),(0,a.createElement)(Re,{event:t}))))))}function Ve(e){const{event:t,variant:n="normal",mapsApiKey:r,hasExtendedSettingsAddOn:s,isNewAfterFetchNewEvents:i}=e,o=x("SimpleHistoryLogitem",`SimpleHistoryLogitem--variant-${n}`,`SimpleHistoryLogitem--loglevel-${t.loglevel}`,`SimpleHistoryLogitem--logger-${t.logger}`,`SimpleHistoryLogitem--initiator-${t.initiator}`,{"SimpleHistoryLogitem--newRowSinceReload":i});return(0,a.createElement)("li",{key:t.id,className:o},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__firstcol"},(0,a.createElement)(Ae,{event:t})),(0,a.createElement)("div",{className:"SimpleHistoryLogitem__secondcol"},(0,a.createElement)(Ie,{event:t,eventVariant:n,mapsApiKey:r,hasExtendedSettingsAddOn:s}),(0,a.createElement)(Be,{event:t,eventVariant:n}),(0,a.createElement)(Se,{event:t,eventVariant:n}),(0,a.createElement)(ze,{event:t,eventVariant:n,hasExtendedSettingsAddOn:s}),(0,a.createElement)(qe,{event:t,eventVariant:n})))}function Ge(e){const{eventId:t,closeModal:n=null}=e,[r,s]=(0,i.useState)(null),[o,c]=(0,i.useState)(!0);return(0,i.useEffect)((()=>{(async()=>{c(!0);const e=await l()({path:(0,m.addQueryArgs)("/simple-history/v1/events/"+t,{_fields:["id","logger","occasions_id","subsequent_occasions_count","initiator_data","loglevel","message","message_html","message_key","details_data","details_html","message_uninterpolated","date","date_gmt","message","context","ip_addresses","details_data","via","initiator"]}),parse:!1}),n=await e.json();s(n),c(!1)})()}),[t]),(0,a.createElement)(u.Modal,{title:(0,d.__)("Event details","simple-history"),onRequestClose:n},(0,a.createElement)("div",{className:"SimpleHistory__modal"},o?(0,d.__)("Loading detailed events data…","simple-history"):(0,a.createElement)(a.Fragment,null,(0,a.createElement)(Ve,{event:r,variant:"modal"}),(0,a.createElement)("p",null,(0,a.createElement)(u.__experimentalText,null,(0,d.__)("This is potentially useful information and meta data that a logger has saved.","simple-history"))),(0,a.createElement)("h2",null,(0,d.__)("Event details","simple-history")),(0,a.createElement)("table",{className:"SimpleHistoryLogitem__moreDetailsContext"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,(0,d.__)("Key","simple-history")),(0,a.createElement)("th",null,(0,d.__)("Value","simple-history")))),(0,a.createElement)("tbody",null,(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"id"),(0,a.createElement)("td",null,r.id)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"logger"),(0,a.createElement)("td",null,r.logger)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"level"),(0,a.createElement)("td",null,r.loglevel)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"date"),(0,a.createElement)("td",null,r.date)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"message"),(0,a.createElement)("td",null,r.message)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"message_uninterpolated"),(0,a.createElement)("td",null,r.message_uninterpolated)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"initiator"),(0,a.createElement)("td",null,r.initiator)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"subsequent_occasions_count"),(0,a.createElement)("td",null,r.subsequent_occasions_count)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"via"),(0,a.createElement)("td",null,r.via)))),(0,a.createElement)("h2",null,(0,d.__)("Event context","simple-history")),(0,a.createElement)("table",{className:"SimpleHistoryLogitem__moreDetailsContext"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,(0,d.__)("Key","simple-history")),(0,a.createElement)("th",null,(0,d.__)("Value","simple-history")))),(0,a.createElement)("tbody",null,Object.entries(r.context||{}).map((([e,t])=>(0,a.createElement)("tr",{key:e},(0,a.createElement)("td",null,e),(0,a.createElement)("td",null,JSON.stringify(t))))))))))}function $e(){const e=(()=>{const[e,t]=(0,i.useState)(window.location.hash),n=()=>{t(window.location.hash)};return(0,i.useEffect)((()=>(window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)})),[]),e})(),[t,n]=(0,i.useState)(!1),[r,s]=(0,i.useState)(null);(0,i.useEffect)((()=>{const t=e.match(/^#simple-history\/event\/(\d+)/);null!==t?(s(parseInt(t[1],10)),n(!0)):n(!1)}),[e]);return t?(0,a.createElement)(Ge,{eventId:r,closeModal:()=>{n(!1),window.location.hash=""}}):null}const Qe=(0,p.jsx)(h.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(h.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})});function Ue(e){const{eventsQueryParams:t,eventsMaxId:n,onReload:r}=e,[s,o]=(0,i.useState)(0);(0,i.useEffect)((()=>{if(!t||!n)return;const e=setInterval((async()=>{const e={...t,since_id:n,_fields:null};try{const t=await l()({path:(0,m.addQueryArgs)("/simple-history/v1/events/has-updates",e),parse:!1}),n=(await t.json()).new_events_count;n>0&&o(n)}catch(e){console.error("Error when checking for new events:",e)}}),5e3);return()=>{clearInterval(e)}}),[t,n,s]);const c=(0,d.sprintf)(
// translators: %s: number of new events
// translators: %s: number of new events
(0,d._n)("%s new event","%s new events",s,"simple-history"),s);return(0,i.useEffect)((()=>{!function(e){let t=document.title;t=t.replace(/^\([\d!]+\) /,""),e&&(t="("+e+") "+t),document.title=t}(s)}),[s]),(0,a.createElement)("div",{className:x({SimpleHistoryDropin__NewRowsNotifier:!0,"SimpleHistoryDropin__NewRowsNotifier--haveNewRows":s>0})},(0,a.createElement)(u.Button,{icon:Qe,onClick:()=>{r(),o(0)},label:(0,d.__)("Click to load new events","simple-history"),showTooltip:!0,variant:"tertiary",style:{width:"100%",justifyContent:"center"}},c))}const Xe=(0,p.jsx)(h.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(h.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})}),Ke=(0,p.jsx)(h.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(h.Path,{d:"M10.6 6L9.4 7l4.6 5-4.6 5 1.2 1 5.4-6z"})});function Je(e){const{page:t,totalPages:n,onClickPrev:r,onClickNext:s,onChangePage:o}=e;return t&&n?(0,a.createElement)("div",null,(0,a.createElement)(u.__experimentalHStack,{spacing:4,justify:"center"},(0,a.createElement)(u.Button,{label:(0,d.__)("Previous page","simple-history"),size:"compact",onClick:r,disabled:1===t,accessibleWhenDisabled:!0,icon:Xe}),(0,a.createElement)(u.__experimentalHStack,{justify:"flex-start",expanded:!1,spacing:2},(0,i.createInterpolateElement)((0,d.sprintf)(
// translators: %s: Total number of pages.
// translators: %s: Total number of pages.
(0,d._x)("Page <CurrentPageControl /> of %s","paging","simple-history"),n),{CurrentPageControl:(0,a.createElement)(u.SelectControl,{"aria-label":(0,d.__)("Current page","simple-history"),value:t,options:[...Array(n)].map(((e,t)=>({label:t+1,value:t+1}))),onChange:o,size:"compact",__nextHasNoMarginBottom:!0})})),(0,a.createElement)(u.Button,{label:(0,d.__)("Next page","simple-history"),size:"compact",onClick:s,disabled:t===n,accessibleWhenDisabled:!0,icon:Ke}))):null}function Ze(e){const{events:t,page:n,setPage:r,eventsIsLoading:s,eventsMeta:i,prevEventsMaxId:o,mapsApiKey:l,hasExtendedSettingsAddOn:c}=e,m=i.totalPages,h=x({SimpleHistoryLogitems:!0,"is-loading":s});return(0,a.createElement)("div",{style:{backgroundColor:"white",minHeight:"300px"}},!1===s&&0===t.length&&(0,a.createElement)("p",{style:{padding:"1rem"}},(0,d.__)("Your search did not match any history events.","simple-history")),(0,a.createElement)("ul",{className:h},t.map((e=>(0,a.createElement)(Ve,{key:e.id,event:e,mapsApiKey:l,hasExtendedSettingsAddOn:c,isNewAfterFetchNewEvents:e.id>o})))),(0,a.createElement)(u.__experimentalSpacer,{margin:4}),(0,a.createElement)(Je,{page:n,totalPages:m,onClickPrev:()=>r(n-1),onClickNext:()=>r(n+1),onChangePage:e=>r(parseInt(e,10))}),(0,a.createElement)(u.__experimentalSpacer,{paddingBottom:4}))}function et(e){const{dateOptions:t,selectedDateOption:n,setSelectedDateOption:r,searchText:s,setSearchText:o,selectedCustomDateFrom:l,setSelectedCustomDateFrom:c,selectedCustomDateTo:m,setSelectedCustomDateTo:h}=e,p=e=>e>new Date;return(0,i.useEffect)((()=>{l&&m&&l>m&&h(l)}),[l,m,h]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("p",null,(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Dates","simple-history")),(0,a.createElement)("div",{style:{display:"inline-block",width:"310px"}},(0,a.createElement)(u.SelectControl,{options:t,value:n,onChange:e=>r(e)}))),"customRange"===n?(0,a.createElement)((function(){const e=(0,xe.getSettings)().l10n.startOfWeek;return(0,a.createElement)(u.Flex,{justify:"start",gap:"15"},(0,a.createElement)(u.FlexItem,{style:{width:"95px"}}),(0,a.createElement)(u.FlexItem,null,(0,a.createElement)(u.BaseControl,{label:(0,d.__)("From date","simple-history")},(0,a.createElement)(u.DatePicker,{id:"simple-history-datepicker-from",startOfWeek:e,onChange:e=>{c(de(W(e),_e))},currentDate:l,isInvalidDate:p}))),(0,a.createElement)(u.FlexItem,null,(0,a.createElement)(u.BaseControl,{label:(0,d.__)("To date","simple-history")},(0,a.createElement)(u.DatePicker,{startOfWeek:e,onChange:e=>{h(de(pe(e),_e))},currentDate:m,isInvalidDate:p}))))}),null):null,(0,a.createElement)("p",null,(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},"Containing words"),(0,a.createElement)("input",{type:"search",className:"SimpleHistoryFilterDropin-searchInput",value:s,onChange:e=>o(e.target.value)})))}function tt(e){const{messageTypesSuggestions:t,selectedLogLevels:n,setSelectedLogLevels:r,selectedMessageTypes:s,setSelectedMessageTypes:o,selectedUsersWithId:c,setSelectedUsersWithId:h}=e,[p,g]=(0,i.useState)([]),f=ye.map((e=>e.label));return(0,a.createElement)("div",null,(0,a.createElement)(u.Flex,{align:"top",gap:"0",style:{margin:"0.5em 0"}},(0,a.createElement)(u.FlexItem,{style:{margin:".5em 0"}},(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Log levels","simple-history"))),(0,a.createElement)(u.FlexBlock,null,(0,a.createElement)("div",{className:"SimpleHistory__filters__loglevels__select",style:{width:"310px",backgroundColor:"white"}},(0,a.createElement)(u.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,placeholder:(0,d.__)("All log levels","simple-history"),onChange:e=>{r(e)},suggestions:f,value:n})))),(0,a.createElement)(u.Flex,{align:"top",gap:"0",style:{margin:"0.5em 0"}},(0,a.createElement)(u.FlexItem,{style:{margin:".5em 0"}},(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Message types","simple-history"))),(0,a.createElement)(u.FlexBlock,null,(0,a.createElement)("div",{className:"SimpleHistory__filters__loglevels__select",style:{width:"310px",backgroundColor:"white"}},(0,a.createElement)(u.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,label:"",placeholder:(0,d.__)("All message types","simple-history"),onChange:e=>{(e=>{e.map(((n,a)=>{if("string"==typeof n){const r=t.find((e=>e.value.trim()===n.trim()));r&&(e[a]=r)}return n})),o(e)})(e)},value:s.map((e=>(e.value=e.value.replace(ve,""),e))),suggestions:t.map((e=>e.value)),__experimentalRenderItem:e=>e.item.startsWith(ve)?e.item:(0,a.createElement)("strong",null,e.item)})))),(0,a.createElement)(u.Flex,{align:"top",gap:"0",style:{margin:"0.5em 0"}},(0,a.createElement)(u.FlexItem,{style:{margin:".5em 0"}},(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Users","simple-history"))),(0,a.createElement)(u.FlexBlock,null,(0,a.createElement)("div",{className:"SimpleHistory__filters__loglevels__select",style:{width:"310px",backgroundColor:"white"}},(0,a.createElement)(u.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,label:"",placeholder:(0,d.__)("All users","simple-history"),onChange:e=>{(e=>{e.map(((t,n)=>{if("string"==typeof t){const a=p.find((e=>e.value===t));a&&(e[n]=a)}return t})),h(e)})(e)},onInputChange:e=>{(async e=>{e.length<2||l()({path:(0,m.addQueryArgs)("/simple-history/v1/search-user",{q:e})}).then((e=>{const t=[];e.forEach((e=>{t.push({id:e.id,value:e.display_name+" ("+e.user_email+")"})})),g(t)}))})(e)},suggestions:p.map((e=>e.value)),value:c})),(0,a.createElement)(u.BaseControl,{__nextHasNoMarginBottom:!0,help:"Enter 2 or more characters to search for users."}))))}function nt(e){const{onReload:t,selectedLogLevels:n,setSelectedLogLevels:r,selectedMessageTypes:s,setSelectedMessageTypes:o,selectedDateOption:c,setSelectedDateOption:h,enteredSearchText:p,setEnteredSearchText:g,selectedCustomDateFrom:f,setSelectedCustomDateFrom:y,selectedCustomDateTo:_,setSelectedCustomDateTo:v,messageTypesSuggestions:w,setMessageTypesSuggestions:E,selectedUsersWithId:b,setSelectedUsersWithId:S,searchOptionsLoaded:x,setSearchOptionsLoaded:k,setPagerSize:M,setMapsApiKey:L,setHasExtendedSettingsAddOn:C,setIsExperimentalFeaturesEnabled:T,setEventsAdminPageURL:D}=e,[H,P]=(0,i.useState)(!1),[I,F]=(0,i.useState)(fe);(0,i.useEffect)((()=>{l()({path:(0,m.addQueryArgs)("/simple-history/v1/search-options",{})}).then((e=>{const t=e.dates.result_months.map((e=>({label:(0,xe.dateI18n)("F Y",e.yearMonth),value:`month:${e.yearMonth}`}))),n={label:(0,d.__)("All dates","simple-history"),value:"allDates"};F([...ge,...t,n]),h(`lastdays:${e.dates.daysToShow}`);const a=[];e.loggers.forEach((e=>{const t=e.search_data||{};t.search&&(a.push({value:t.search.label,search_options:t.search.options}),t?.search_all?.label&&a.push({value:ve+t.search_all.label,search_options:t.search_all.options}),t?.search_options&&t.search_options.forEach((e=>{a.push({value:ve+e.label,search_options:e.options})})))})),E(a),M(e.pager_size),L(e.maps_api_key),C(e.addons.has_extended_settings_add_on),T(e.experimental_features_enabled),D(e.events_admin_page_url),k(!0)}))}),[E,M,k,h,L,C,T,D]);const N=H?(0,d.__)("Collapse search options","simple-history"):(0,d.__)("Show search options","simple-history"),O=x?i.Fragment:u.Disabled;return(0,a.createElement)(O,null,(0,a.createElement)("div",{className:"SimpleHistory-filters"},(0,a.createElement)(et,{dateOptions:I,selectedDateOption:c,setSelectedDateOption:h,searchText:p,setSearchText:g,selectedCustomDateFrom:f,setSelectedCustomDateFrom:y,selectedCustomDateTo:_,setSelectedCustomDateTo:v}),H?(0,a.createElement)(tt,{messageTypesSuggestions:w,setMessageTypesSuggestions:E,selectedLogLevels:n,setSelectedLogLevels:r,selectedMessageTypes:s,setSelectedMessageTypes:o,setSelectedUsersWithId:S,selectedUsersWithId:b}):null,(0,a.createElement)("p",{className:"SimpleHistory__filters__filterSubmitWrap"},(0,a.createElement)("button",{className:"button",onClick:t},(0,d.__)("Search events","simple-history")),(0,a.createElement)("button",{type:"button",onClick:()=>P(!H),className:"SimpleHistoryFilterDropin-showMoreFilters SimpleHistoryFilterDropin-showMoreFilters--first js-SimpleHistoryFilterDropin-showMoreFilters"},N))))}const at=function(){const[e,t]=(0,i.useState)(!0),[n,r]=(0,i.useState)([]),[s,o]=(0,i.useState)({}),[u,d]=(0,i.useState)(Date.now()),[h,p]=(0,i.useState)(),[g,f]=(0,i.useState)(),[y,_]=(0,i.useState)(!1),[v,E]=(0,i.useState)(1),[b,S]=(0,i.useState)({}),[x,k]=(0,i.useState)(""),[M,L]=(0,i.useState)(!1),[C,T]=(0,i.useState)(!1),[D,H]=(0,i.useState)(),[P,I]=(0,i.useState)(""),[F,N]=(0,i.useState)(we),[O,A]=(0,i.useState)(Ee),[W,j]=(0,i.useState)(""),[z,B]=(0,i.useState)([]),[R,Y]=(0,i.useState)([]),[q,V]=(0,i.useState)([]),[G,$]=(0,i.useState)([]),Q=(0,i.useMemo)((()=>function(e){const{selectedLogLevels:t,selectedMessageTypes:n,selectedUsersWithId:a,enteredSearchText:r,selectedDateOption:s,selectedCustomDateFrom:i,selectedCustomDateTo:o,page:l,pagerSize:c}=e;let m=c.page;"dashboard"===window.pagenow&&(m=c.dashboard);const u={page:l,per_page:m,_fields:["id","logger","date","date_gmt","message","message_html","message_key","details_data","details_html","loglevel","occasions_id","subsequent_occasions_count","initiator","initiator_data","ip_addresses","via","permalink"]};if(r&&(u.search=r),s&&("customRange"===s?(u.date_from=i,u.date_to=o):u.dates=s),t.length){const e=[];t.forEach((t=>{const n=ye.find((e=>e.label===t));n&&e.push(n.value)})),e.length&&(u.loglevels=e)}if(n.length){const e=[];n.forEach((t=>{t.search_options.forEach((t=>{e.push(t)}))})),u.messages=e.join(",")}if(a.length){const e=a.map((e=>e.id));u.users=e}return u}({selectedLogLevels:z,selectedMessageTypes:q,selectedUsersWithId:G,enteredSearchText:W,selectedDateOption:P,selectedCustomDateFrom:F,selectedCustomDateTo:O,page:v,pagerSize:b})),[P,W,z,q,G,F,O,v,b]);(0,i.useEffect)((()=>{E(1)}),[P,W,z,q,F,O]);const U=(0,i.useCallback)((async()=>{t(!0);try{const e=await l()({path:(0,m.addQueryArgs)("/simple-history/v1/events",Q),parse:!1}),t=await e.json();o({total:parseInt(e.headers.get("X-Wp-Total"),10),totalPages:parseInt(e.headers.get("X-Wp-Totalpages"),10),link:e.headers.get("Link")}),t&&t.length&&1===v&&p(t[0].id),r(t)}catch(e){console.error("Error loading events:",e)}finally{t(!1)}}),[Q,v]),X=(0,c.useDebounce)(U,500);(0,i.useEffect)((()=>{y&&X()}),[X,y,u]);const K=()=>{E(1),f(h),d(Date.now())};return(0,i.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[v]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)(nt,{selectedLogLevels:z,setSelectedLogLevels:B,selectedMessageTypes:q,setSelectedMessageTypes:V,selectedDateOption:P,setSelectedDateOption:I,enteredSearchText:W,setEnteredSearchText:j,selectedCustomDateFrom:F,setSelectedCustomDateFrom:N,selectedCustomDateTo:O,setSelectedCustomDateTo:A,messageTypesSuggestions:R,setMessageTypesSuggestions:Y,selectedUsersWithId:G,setSelectedUsersWithId:$,searchOptionsLoaded:y,setSearchOptionsLoaded:_,setPagerSize:S,setMapsApiKey:k,setHasExtendedSettingsAddOn:L,setIsExperimentalFeaturesEnabled:T,eventsAdminPageURL:D,setEventsAdminPageURL:H,setPage:E,onReload:K}),(0,a.createElement)(w,{isExperimentalFeaturesEnabled:C,eventsIsLoading:e,eventsTotal:s.total,eventsMaxId:h,eventsQueryParams:Q,onReload:K}),(0,a.createElement)(Ue,{eventsQueryParams:Q,eventsMaxId:h,onReload:K}),(0,a.createElement)(Ze,{eventsIsLoading:e,events:n,eventsMeta:s,page:v,setPage:E,eventsMaxId:h,prevEventsMaxId:g,mapsApiKey:x,hasExtendedSettingsAddOn:M}),(0,a.createElement)($e,null))};s()((()=>{const e=document.getElementById("simple-history-react-root");e&&(i.createRoot?(0,i.createRoot)(e).render((0,a.createElement)(at,null)):(0,i.render)((0,a.createElement)(at,null),e))}))})();